{"version":3,"file":"component.test.js","names":["html","component","render","reactive","signal","createSignal","createSignalFunction","signalify","createMutable","describe","it","_initClass","onMountCalled","onCleanupCalled","_CoolComp","CoolComp","_applyDecs","c","onMount","onCleanup","template","props","expect","foo","toBe","root","document","createElement","body","append","dispose","textContent","remove","_initProto","e","constructor","toThrow","_initClass2","_init_foo","_init_extra_foo","_init_bar","_init_extra_bar","_CoolComp2","bar","a","setA","b","xit","_initClass3","_init_foo2","_init_extra_foo2","_init_bar2","_init_extra_bar2","_CoolComp3","o"],"sources":["../../src/decorators/component.test.ts"],"sourcesContent":["import html from 'solid-js/html'\nimport {component} from './component.js'\nimport {render} from 'solid-js/web'\nimport {reactive} from './reactive.js'\nimport {signal} from './signal.js'\nimport {createSignal} from 'solid-js'\nimport {createSignalFunction} from '../signals/createSignalFunction.js'\nimport {signalify} from '../signals/signalify.js'\nimport {createMutable} from 'solid-js/store'\n\ndescribe('classy-solid', () => {\n\tdescribe('@component', () => {\n\t\tit('allows to define a class using class syntax', () => {\n\t\t\tlet onMountCalled = false\n\t\t\tlet onCleanupCalled = false\n\n\t\t\t@component\n\t\t\tclass CoolComp {\n\t\t\t\tonMount() {\n\t\t\t\t\tonMountCalled = true\n\t\t\t\t}\n\n\t\t\t\tonCleanup() {\n\t\t\t\t\tonCleanupCalled = true\n\t\t\t\t}\n\n\t\t\t\ttemplate(props: any) {\n\t\t\t\t\texpect(props.foo).toBe(123)\n\t\t\t\t\treturn html`<div>hello classes!</div>`\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst root = document.createElement('div')\n\t\t\tdocument.body.append(root)\n\n\t\t\tconst dispose = render(() => html`<${CoolComp} foo=${123} />`, root)\n\n\t\t\texpect(root.textContent).toBe('hello classes!')\n\t\t\texpect(onMountCalled).toBe(true)\n\t\t\texpect(onCleanupCalled).toBe(false)\n\n\t\t\tdispose()\n\t\t\troot.remove()\n\n\t\t\texpect(onCleanupCalled).toBe(true)\n\n\t\t\t// throws on non-class use\n\t\t\texpect(() => {\n\t\t\t\tclass CoolComp {\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t@component\n\t\t\t\t\tonMount() {}\n\t\t\t\t}\n\t\t\t\tCoolComp\n\t\t\t}).toThrow('component decorator should only be used on a class')\n\t\t})\n\n\t\tit('works in tandem with @reactive and @signal for reactivity', async () => {\n\t\t\t@component\n\t\t\t@reactive\n\t\t\tclass CoolComp {\n\t\t\t\t@signal foo = 0\n\t\t\t\t@signal bar = 0\n\n\t\t\t\ttemplate() {\n\t\t\t\t\treturn html`<div>foo: ${() => this.foo}, bar: ${() => this.bar}</div>`\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst root = document.createElement('div')\n\t\t\tdocument.body.append(root)\n\n\t\t\tconst [a, setA] = createSignal(1)\n\t\t\tconst b = createSignalFunction(2)\n\n\t\t\t// FIXME Why do we need `() => b()` instead of just `b` here? Does `html`\n\t\t\t// check the `length` of the function and do something based on\n\t\t\t// that? Or does it get passed to a @signal property's setter and\n\t\t\t// receives the previous value?\n\t\t\tconst dispose = render(() => html`<${CoolComp} foo=${a} bar=${() => b()} />`, root)\n\n\t\t\texpect(root.textContent).toBe('foo: 1, bar: 2')\n\n\t\t\tsetA(3)\n\t\t\tb(4)\n\n\t\t\texpect(root.textContent).toBe('foo: 3, bar: 4')\n\n\t\t\tdispose()\n\t\t\troot.remove()\n\t\t})\n\n\t\tit('works without decorators', () => {\n\t\t\tconst CoolComp = component(\n\t\t\t\tclass CoolComp {\n\t\t\t\t\tfoo = 0\n\t\t\t\t\tbar = 0\n\n\t\t\t\t\tconstructor() {\n\t\t\t\t\t\tsignalify(this)\n\t\t\t\t\t}\n\n\t\t\t\t\ttemplate() {\n\t\t\t\t\t\treturn html`<div>foo: ${() => this.foo}, bar: ${() => this.bar}</div>`\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t)\n\n\t\t\tconst root = document.createElement('div')\n\t\t\tdocument.body.append(root)\n\n\t\t\tconst [a, setA] = createSignal(1)\n\t\t\tconst b = createSignalFunction(2)\n\n\t\t\t// FIXME Why do we need `() => b()` instead of just `b` here? Does `html`\n\t\t\t// check the `length` of the function and do something based on\n\t\t\t// that? Or does it get passed to a @signal property's setter and\n\t\t\t// receives the previous value?\n\t\t\tconst dispose = render(() => html`<${CoolComp} foo=${a} bar=${() => b()} />`, root)\n\n\t\t\texpect(root.textContent).toBe('foo: 1, bar: 2')\n\n\t\t\tsetA(3)\n\t\t\tb(4)\n\n\t\t\texpect(root.textContent).toBe('foo: 3, bar: 4')\n\n\t\t\tdispose()\n\t\t\troot.remove()\n\t\t})\n\n\t\t// FIXME not working, the spread doesn't seem to do anything.\n\t\txit('works with reactive spreads', async () => {\n\t\t\t@component\n\t\t\t@reactive\n\t\t\tclass CoolComp {\n\t\t\t\t@signal foo = 0\n\t\t\t\t@signal bar = 0\n\n\t\t\t\ttemplate() {\n\t\t\t\t\treturn html`<div>foo: ${() => this.foo}, bar: ${() => this.bar}</div>`\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst root = document.createElement('div')\n\t\t\tdocument.body.append(root)\n\n\t\t\tlet o = createMutable<any>({o: {foo: 123}})\n\n\t\t\t// neither of these work\n\t\t\t// const dispose = render(() => html`<${CoolComp} ...${() => o.o} />`, root)\n\t\t\tconst dispose = render(() => html`<${CoolComp} ...${o.o} />`, root)\n\n\t\t\texpect(root.textContent).toBe('foo: 123, bar: 0')\n\n\t\t\to.o = {bar: 456}\n\n\t\t\texpect(root.textContent).toBe('foo: 123, bar: 456')\n\n\t\t\tdispose()\n\t\t\troot.remove()\n\t\t})\n\t})\n})\n"],"mappings":"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","ignoreList":[]}