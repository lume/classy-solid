{"version":3,"file":"signal.js","names":["batch","getSignal__","trackPropSetAtLeastOnce__","isSignalGetter__","getMemberStat__","finalizeMembersIfLast__","getMembers__","signalifyIfNeeded__","Undefined","Symbol","isExtending","WeakSet","signal","valueOrOptions","context","signalImplementation","options","value","extend","static","Error","kind","name","metadata","members","InvalidSignalDecoratorError","private","stat","finalize","addInitializer","reuseExistingSignal","newInitialValue","Object","defineProperty","existingSignalDescriptor","initialVal","descriptor","getOwnPropertyDescriptor","has","get","set","signalStorage","WeakMap","initialValue","init","proto","getPrototypeOfMethodOrAccessor","newGet","currentProto","fn","__proto__","Reflect","call","add","newSet","newValue","s","getOrSet","hasOwn","classySolid_getterSetterSignals","signalsStorages","classySolid_getterSetterPairCounts","pairs","queueMicrotask","missing","MissingSignalDecoratorError","newGetter","newSetter","constructor","prop","String","obj","getPrototypeOf"],"sources":["../../src/decorators/signal.ts"],"sourcesContent":["import {batch} from 'solid-js'\nimport {getSignal__, trackPropSetAtLeastOnce__} from '../signals/signalify.js'\nimport type {AnyObject, ClassySolidMetadata, PropKey} from './types.js'\nimport type {SignalFunction} from '../signals/createSignalFunction.js'\nimport {\n\tisSignalGetter__,\n\tgetMemberStat__,\n\tfinalizeMembersIfLast__,\n\tgetMembers__,\n\tsignalifyIfNeeded__,\n} from '../_state.js'\nimport './metadata-shim.js'\n\nconst Undefined = Symbol()\nconst isExtending = new WeakSet<Function>()\n\nexport interface SignalOptions {\n\t/**\n\t * Whether to extend an existing base class signal instead of creating a new\n\t * one. When true, the existing signal is reused, otherwise a new signal\n\t * overrides the existing one from the base class.\n\t *\n\t * Defaults to true, as typically we want base class effects and memos to\n\t * keep working when a subclass overrides a signal property.\n\t */\n\textend?: boolean\n}\n\n/**\n * @decorator\n * Decorate properties of a class with `@signal` to back them with Solid\n * signals, making them reactive.\n *\n * Related: See the Solid.js `createSignal` API for creating standalone signals.\n *\n * Example:\n *\n * ```js\n * import {signal} from 'classy-solid'\n * import {createEffect} from 'solid-js'\n *\n * class Counter {\n *   ⁣@signal count = 0\n *\n *   constructor() {\n *     setInterval(() => this.count++, 1000)\n *\n *     createEffect(() => {\n *       console.log('count:', this.count)\n *     })\n *   }\n * }\n *\n * const counter = new Counter()\n *\n * // When extending a class with a signal field, the subclass can override\n * // the initial value while keeping base class effects and memos working:\n * class SubCounter extends Counter {\n *   ⁣@signal override count = 10 // starts at 10 instead of 0\n * }\n * ```\n */\nexport function signal(\n\tvalue: unknown,\n\tcontext:\n\t\t| ClassFieldDecoratorContext\n\t\t| ClassGetterDecoratorContext\n\t\t| ClassSetterDecoratorContext\n\t\t| ClassAccessorDecoratorContext,\n): any\nexport function signal(options: SignalOptions): typeof signalImplementation\nexport function signal(\n\tvalueOrOptions: unknown | SignalOptions,\n\tcontext?:\n\t\t| ClassFieldDecoratorContext\n\t\t| ClassGetterDecoratorContext\n\t\t| ClassSetterDecoratorContext\n\t\t| ClassAccessorDecoratorContext,\n): any {\n\t// Used as `@signal` without options\n\tif (context) return signalImplementation(valueOrOptions, context)\n\n\t// Used as `@signal({...})` with options\n\n\tconst options = valueOrOptions as SignalOptions\n\n\treturn function (\n\t\tvalue: unknown,\n\t\tcontext:\n\t\t\t| ClassFieldDecoratorContext\n\t\t\t| ClassGetterDecoratorContext\n\t\t\t| ClassSetterDecoratorContext\n\t\t\t| ClassAccessorDecoratorContext,\n\t) {\n\t\treturn signalImplementation(value, context, options)\n\t}\n}\n\nfunction signalImplementation(\n\tvalue: unknown,\n\tcontext:\n\t\t| ClassFieldDecoratorContext\n\t\t| ClassGetterDecoratorContext\n\t\t| ClassSetterDecoratorContext\n\t\t| ClassAccessorDecoratorContext,\n\toptions: SignalOptions = {extend: true},\n): any {\n\tif (context.static) throw new Error('@signal is not supported on static fields yet.')\n\n\toptions.extend ??= true\n\n\tconst {kind, name} = context\n\tconst metadata = context.metadata as ClassySolidMetadata\n\tconst members = getMembers__(metadata)\n\n\tif (!(kind === 'field' || kind === 'accessor' || kind === 'getter' || kind === 'setter'))\n\t\tthrow new InvalidSignalDecoratorError()\n\n\tif (kind === 'field') {\n\t\tif (context.private)\n\t\t\tthrow new Error(\n\t\t\t\t'@signal cannot signalify #private fields. Use a #private getter/setter or auto accessor instead. F.e. convert `@signal #foo = 0` to `@signal accessor #foo = 0`.',\n\t\t\t)\n\n\t\tconst stat = getMemberStat__(name, 'signal-field', members, context)\n\n\t\tstat.finalize = function () {\n\t\t\tsignalifyIfNeeded__(this as AnyObject, stat)\n\t\t}\n\n\t\tcontext.addInitializer(function () {\n\t\t\tif (stat.reuseExistingSignal) {\n\t\t\t\t// Delete the value descriptor, put back the signal descriptor,\n\t\t\t\t// and set the new initial value.\n\t\t\t\tstat.newInitialValue = (this as AnyObject)[name]\n\t\t\t\tdelete (this as AnyObject)[name]\n\t\t\t\tObject.defineProperty(this as AnyObject, name, stat.existingSignalDescriptor!)\n\t\t\t\t;(this as AnyObject)[name] = stat.newInitialValue\n\t\t\t}\n\t\t\tfinalizeMembersIfLast__(this as AnyObject, members)\n\t\t})\n\n\t\treturn function (this: unknown, initialVal: unknown) {\n\t\t\t// Detect if we already have a signal for this instance, and if so\n\t\t\t// re-use it.  This allows base class effects to stay operational\n\t\t\t// instead of a new signal being created that the base class effect\n\t\t\t// won't track.\n\t\t\tconst descriptor = Object.getOwnPropertyDescriptor(this as AnyObject, name)\n\n\t\t\t// If we already have a signal descriptor, we will re-use it, so\n\t\t\t// that any effects depending on it will continue to work.\n\t\t\tif (isSignalGetter__.has(descriptor?.get!)) {\n\t\t\t\tstat.reuseExistingSignal = true\n\t\t\t\tstat.newInitialValue = initialVal\n\t\t\t\tstat.existingSignalDescriptor = descriptor\n\t\t\t}\n\n\t\t\t// The engine will define the property with this value in a value\n\t\t\t// descriptor, which we need to convert to a signal accessor\n\t\t\t// descriptor again (or for first time).\n\t\t\treturn initialVal\n\t\t}\n\t}\n\n\t// It's ok that getters/setters/auto-accessors are not finalized the same\n\t// way as with fields above and as with memos/effects, because we do the set\n\t// up during decoration which happens well before any initializers (before\n\t// any memos and effects, so these will be tracked).\n\telse if (kind === 'accessor') {\n\t\tconst {get, set} = value as {get: () => unknown; set: (v: unknown) => void}\n\t\tconst signalStorage = new WeakMap<object, SignalFunction<unknown>>()\n\t\tlet initialValue: unknown = Undefined\n\n\t\tconst init = (initialVal: unknown) => (initialValue = initialVal)\n\n\t\tcontext.addInitializer(function () {\n\t\t\t// Locate the prototype of this auto accessor.\n\t\t\tconst proto = getPrototypeOfMethodOrAccessor(this as AnyObject, name, newGet)\n\n\t\t\t// If not already deleted to unshadow base class accessor\n\t\t\tif (proto) {\n\t\t\t\t// While not on the current prototype, delete subclass descriptors if they are marked as extending.\n\t\t\t\tlet currentProto: AnyObject = this as AnyObject\n\t\t\t\twhile (currentProto && currentProto !== proto) {\n\t\t\t\t\tconst descriptor = Object.getOwnPropertyDescriptor(currentProto, name)\n\t\t\t\t\tconst fn = descriptor?.get\n\n\t\t\t\t\t// Delete the subclass descriptor to unshadow the base class\n\t\t\t\t\t// descriptor.\n\t\t\t\t\tif (fn && isExtending.has(fn)) delete currentProto[name]\n\n\t\t\t\t\tcurrentProto = currentProto.__proto__ as AnyObject\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tReflect.set(proto ?? (this as AnyObject), name, initialValue, this)\n\t\t})\n\n\t\tfunction newGet(this: object): unknown {\n\t\t\tgetSignal__(this, signalStorage, initialValue)()\n\t\t\treturn get.call(this)\n\t\t}\n\n\t\tif (options.extend) isExtending.add(newGet)\n\n\t\tfunction newSet(this: object, newValue: unknown) {\n\t\t\t// batch, for example in case setter calls super setter, to\n\t\t\t// avoid multiple effect runs on a single property set.\n\t\t\tbatch(() => {\n\t\t\t\tset.call(this, newValue)\n\t\t\t\ttrackPropSetAtLeastOnce__(this, name) // TODO still needed? test it. I think it is still needed for @lume/element.\n\n\t\t\t\tconst s = getSignal__(this, signalStorage, initialValue)\n\t\t\t\ts(typeof newValue === 'function' ? () => newValue : newValue)\n\t\t\t})\n\t\t}\n\n\t\tconst newValue = {init, get: newGet, set: newSet}\n\n\t\tisSignalGetter__.add(newValue.get)\n\n\t\treturn newValue\n\t} else if (kind === 'getter' || kind === 'setter') {\n\t\tconst getOrSet = value as Function\n\t\tconst initialValue = Undefined\n\n\t\tif (!Object.hasOwn(metadata, 'classySolid_getterSetterSignals')) metadata.classySolid_getterSetterSignals = {}\n\t\tconst signalsStorages = metadata.classySolid_getterSetterSignals!\n\n\t\tlet signalStorage = signalsStorages[name]\n\t\tif (!signalStorage) signalsStorages[name] = signalStorage = new WeakMap<object, SignalFunction<unknown>>()\n\n\t\tif (!Object.hasOwn(metadata, 'classySolid_getterSetterPairCounts')) metadata.classySolid_getterSetterPairCounts = {}\n\t\tconst pairs = metadata.classySolid_getterSetterPairCounts!\n\n\t\t// Show a helpful error in case someone forgets to decorate both a getter and setter.\n\t\tqueueMicrotask(() => {\n\t\t\tqueueMicrotask(() => delete metadata.classySolid_getterSetterPairCounts)\n\t\t\tconst missing = pairs[name] !== 2\n\t\t\tif (missing) throw new MissingSignalDecoratorError(name)\n\t\t})\n\n\t\tif (kind === 'getter') {\n\t\t\tpairs[name] ??= 0\n\t\t\tpairs[name]++\n\n\t\t\tconst newGetter = function (this: object): unknown {\n\t\t\t\tgetSignal__(this, signalStorage, initialValue)()\n\t\t\t\treturn getOrSet.call(this)\n\t\t\t}\n\n\t\t\tisSignalGetter__.add(newGetter)\n\n\t\t\treturn newGetter\n\t\t} else {\n\t\t\tpairs[name] ??= 0\n\t\t\tpairs[name]++\n\n\t\t\tconst newSetter = function (this: object, newValue: unknown) {\n\t\t\t\t// batch, for example in case setter calls super setter, to\n\t\t\t\t// avoid multiple effect runs on a single property set.\n\t\t\t\tbatch(() => {\n\t\t\t\t\tgetOrSet.call(this, newValue)\n\t\t\t\t\ttrackPropSetAtLeastOnce__(this, name)\n\n\t\t\t\t\tconst s = getSignal__(this, signalStorage, initialValue)\n\t\t\t\t\ts(typeof newValue === 'function' ? () => newValue : newValue)\n\t\t\t\t})\n\t\t\t}\n\n\t\t\treturn newSetter\n\t\t}\n\t}\n}\n\nclass MissingSignalDecoratorError extends Error {\n\tconstructor(prop: PropertyKey) {\n\t\tsuper(\n\t\t\t`Missing @signal decorator on setter or getter for property \"${String(\n\t\t\t\tprop,\n\t\t\t)}\". The @signal decorator will only work on a getter/setter pair with *both* getter and setter decorated with @signal.`,\n\t\t)\n\t}\n}\n\nclass InvalidSignalDecoratorError extends Error {\n\tconstructor() {\n\t\tsuper('The @signal decorator is only for use on fields, getters, setters, and auto accessors.')\n\t}\n}\n\n// TODO move this to lowclass\nfunction getPrototypeOfMethodOrAccessor(obj: AnyObject, name: PropKey, fn: Function): AnyObject | null {\n\tlet proto = Object.getPrototypeOf(obj)\n\twhile (proto) {\n\t\tconst descriptor = Object.getOwnPropertyDescriptor(proto, name)\n\t\tif (descriptor && (descriptor.get === fn || descriptor.set === fn || descriptor.value === fn)) return proto\n\t\tproto = Object.getPrototypeOf(proto)\n\t}\n\treturn null\n}\n"],"mappings":"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","ignoreList":[]}