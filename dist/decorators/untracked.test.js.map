{"version":3,"file":"untracked.test.js","names":["createEffect","signal","untracked","memo","reactive","describe","it","_Foo2","_initClass","_init_amount","_init_extra_amount","_initClass2","_init_double","_init_extra_double","_Foo","Foo","e","c","_applyDecs","constructor","amount","_Bar","Bar","double","b","count","noLoop","expect","not","toThrow","toBe","b2","_Foo4","_initClass3","_init_amount2","_init_extra_amount2","_initClass4","_init_double2","_init_extra_double2","_Foo3","_Bar2","_init_amount3","_init_extra_amount3","_initProto","args"],"sources":["../../src/decorators/untracked.test.ts"],"sourcesContent":["import {createEffect} from 'solid-js'\nimport {signal} from './signal.js'\nimport {untracked} from './untracked.js'\nimport {memo} from './memo.js'\nimport {reactive} from './reactive.js'\n\ndescribe('Reactivity Tracking in Constructors', () => {\n\tit('automatically does not track reactivity in constructors when using @untracked', () => {\n\t\t@untracked\n\t\tclass Foo {\n\t\t\t@signal amount = 3\n\t\t}\n\n\t\t@untracked\n\t\tclass Bar extends Foo {\n\t\t\t@signal double = 0\n\n\t\t\tconstructor() {\n\t\t\t\tsuper()\n\t\t\t\tthis.double = this.amount * 2 // this read of .amount should not be tracked\n\t\t\t}\n\t\t}\n\n\t\tlet b: Bar\n\t\tlet count = 0\n\n\t\tfunction noLoop() {\n\t\t\tcreateEffect(() => {\n\t\t\t\tb = new Bar() // this should not track\n\t\t\t\tcount++\n\t\t\t})\n\t\t}\n\n\t\texpect(noLoop).not.toThrow()\n\t\texpect(count).toBe(1)\n\n\t\tconst b2 = b!\n\n\t\tb!.amount = 4 // hence this should not trigger\n\n\t\t// If the effect ran only once initially, not when setting b.colors,\n\t\t// then both variables should reference the same instance\n\t\texpect(count).toBe(1)\n\t\texpect(b!).toBe(b2)\n\t})\n\n\t// deprecated\n\tit('automatically does not track reactivity in constructors when using @reactive', () => {\n\t\t@reactive\n\t\tclass Foo {\n\t\t\t@signal amount = 3\n\t\t}\n\n\t\t@reactive\n\t\tclass Bar extends Foo {\n\t\t\t@signal double = 0\n\n\t\t\tconstructor() {\n\t\t\t\tsuper()\n\t\t\t\tthis.double = this.amount * 2 // this read of .amount should not be tracked\n\t\t\t}\n\t\t}\n\n\t\tlet b: Bar\n\t\tlet count = 0\n\n\t\tfunction noLoop() {\n\t\t\tcreateEffect(() => {\n\t\t\t\tb = new Bar() // this should not track\n\t\t\t\tcount++\n\t\t\t})\n\t\t}\n\n\t\texpect(noLoop).not.toThrow()\n\t\texpect(count).toBe(1)\n\n\t\tconst b2 = b!\n\n\t\tb!.amount = 4 // hence this should not trigger\n\n\t\t// If the effect ran only once initially, not when setting b.colors,\n\t\t// then both variables should reference the same instance\n\t\texpect(count).toBe(1)\n\t\texpect(b!).toBe(b2)\n\t})\n\n\tit('automatically does not track reactivity in constructors when using @memo', () => {\n\t\tclass Foo {\n\t\t\t@signal amount = (() => {\n\t\t\t\tdebugger\n\t\t\t\treturn 3\n\t\t\t})()\n\n\t\t\t// @signal accessor yo = 123\n\n\t\t\t// @signal get bar() {\n\t\t\t// \treturn this\n\t\t\t// }\n\t\t\t// @signal set bar(v) {\n\t\t\t// \t// do nothing\n\t\t\t// }\n\t\t}\n\n\t\tclass Bar extends Foo {\n\t\t\t@memo get double() {\n\t\t\t\treturn this.amount * 2\n\t\t\t}\n\t\t}\n\n\t\tlet b: Bar\n\t\tlet count = 0\n\n\t\tfunction noLoop() {\n\t\t\tcreateEffect(() => {\n\t\t\t\tb = new Bar() // this should not track\n\t\t\t\tcount++\n\t\t\t})\n\t\t}\n\n\t\texpect(noLoop).not.toThrow()\n\t\texpect(count).toBe(1)\n\n\t\tconst b2 = b!\n\n\t\tb!.amount = 4 // hence this should not trigger\n\n\t\t// If the effect ran only once initially, not when setting b.colors,\n\t\t// then both variables should reference the same instance\n\t\texpect(count).toBe(1)\n\t\texpect(b!).toBe(b2)\n\t})\n})\n"],"mappings":"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","ignoreList":[]}